{"version":3,"file":"compileAtomicCSSRule.esm.js","sources":["../../../../packages/core/src/runtime/compileAtomicCSSRule.ts"],"sourcesContent":["import { hyphenateProperty } from './utils/hyphenateProperty';\nimport { normalizeNestedProperty } from './utils/normalizeNestedProperty';\nimport type { AtRules } from './utils/types';\nimport { compileCSSRules } from './compileCSSRules';\n\nexport interface CompileAtomicCSSOptions {\n  className: string;\n  selectors: string[];\n\n  property: string;\n  value: number | string | Array<number | string>;\n\n  rtlClassName?: string;\n  rtlProperty?: string;\n  rtlValue?: number | string | Array<number | string>;\n}\n\nconst PSEUDO_SELECTOR_REGEX = /,( *[^ &])/g;\n\n/**\n * Normalizes pseudo selectors to always contain &, requires to work properly with comma-separated selectors.\n *\n * @example\n *   \":hover\" => \"&:hover\"\n *   \" :hover\" => \"& :hover\"\n *   \":hover,:focus\" => \"&:hover,&:focus\"\n *   \" :hover, :focus\" => \"& :hover,& :focus\"\n */\nexport function normalizePseudoSelector(pseudoSelector: string): string {\n  return (\n    '&' +\n    normalizeNestedProperty(\n      // Regex there replaces a comma, spaces and an ampersand if it's present with comma and an ampersand.\n      // This allows to normalize input, see examples in JSDoc.\n      pseudoSelector.replace(PSEUDO_SELECTOR_REGEX, ',&$1'),\n    )\n  );\n}\n\nfunction createCSSRule(classNameSelector: string, cssDeclaration: string, pseudos: string[]): string {\n  let cssRule = cssDeclaration;\n\n  if (pseudos.length > 0) {\n    cssRule = pseudos.reduceRight((acc, selector) => {\n      return `${normalizePseudoSelector(selector)} { ${acc} }`;\n    }, cssDeclaration);\n  }\n\n  return `${classNameSelector}{${cssRule}}`;\n}\n\nexport function compileAtomicCSSRule(\n  options: CompileAtomicCSSOptions,\n  atRules: AtRules,\n): [string? /* ltr definition */, string? /* rtl definition */] {\n  const { className, selectors, property, rtlClassName, rtlProperty, rtlValue, value } = options;\n  const { container, layer, media, supports } = atRules;\n\n  const classNameSelector = `.${className}`;\n  const cssDeclaration = Array.isArray(value)\n    ? `${value.map(v => `${hyphenateProperty(property)}: ${v}`).join(';')};`\n    : `${hyphenateProperty(property)}: ${value};`;\n\n  let cssRule = createCSSRule(classNameSelector, cssDeclaration, selectors);\n\n  if (rtlProperty && rtlClassName) {\n    const rtlClassNameSelector = `.${rtlClassName}`;\n    const rtlCSSDeclaration = Array.isArray(rtlValue)\n      ? `${rtlValue.map(v => `${hyphenateProperty(rtlProperty)}: ${v}`).join(';')};`\n      : `${hyphenateProperty(rtlProperty)}: ${rtlValue};`;\n\n    cssRule += createCSSRule(rtlClassNameSelector, rtlCSSDeclaration, selectors);\n  }\n\n  if (media) {\n    cssRule = `@media ${media} { ${cssRule} }`;\n  }\n\n  if (layer) {\n    cssRule = `@layer ${layer} { ${cssRule} }`;\n  }\n\n  if (supports) {\n    cssRule = `@supports ${supports} { ${cssRule} }`;\n  }\n\n  if (container) {\n    cssRule = `@container ${container} { ${cssRule} }`;\n  }\n\n  return compileCSSRules(cssRule, true) as [string?, string?];\n}\n"],"names":["PSEUDO_SELECTOR_REGEX","normalizePseudoSelector","pseudoSelector","normalizeNestedProperty","replace","createCSSRule","classNameSelector","cssDeclaration","pseudos","cssRule","length","reduceRight","acc","selector","compileAtomicCSSRule","options","atRules","className","selectors","property","rtlClassName","rtlProperty","rtlValue","value","container","layer","media","supports","Array","isArray","map","v","hyphenateProperty","join","rtlClassNameSelector","rtlCSSDeclaration","compileCSSRules"],"mappings":"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"}